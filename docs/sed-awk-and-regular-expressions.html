<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Sed, awk, and regular expressions | Practical Computing and Bioinformatics for Conservation and Evolutionary Genomics</title>
  <meta name="description" content="A book example for a Chapman &amp; Hall book." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Sed, awk, and regular expressions | Practical Computing and Bioinformatics for Conservation and Evolutionary Genomics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book example for a Chapman &amp; Hall book." />
  <meta name="github-repo" content="yihui/bookdown-crc" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Sed, awk, and regular expressions | Practical Computing and Bioinformatics for Conservation and Evolutionary Genomics" />
  
  <meta name="twitter:description" content="A book example for a Chapman &amp; Hall book." />
  

<meta name="author" content="Eric C. Anderson" />


<meta name="date" content="2020-03-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="shell-programming.html"/>
<link rel="next" href="working-on-remote-servers.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ECA's Bioinformatics Handbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="erics-notes-of-what-he-might-do.html"><a href="erics-notes-of-what-he-might-do.html"><i class="fa fa-check"></i><b>2</b> Eric’s Notes of what he might do</a><ul>
<li class="chapter" data-level="2.1" data-path="erics-notes-of-what-he-might-do.html"><a href="erics-notes-of-what-he-might-do.html#table-of-topics"><i class="fa fa-check"></i><b>2.1</b> Table of topics</a></li>
</ul></li>
<li class="part"><span><b>I Part I: Essential Computing Skills</b></span></li>
<li class="chapter" data-level="3" data-path="overview-of-essential-computing-skills.html"><a href="overview-of-essential-computing-skills.html"><i class="fa fa-check"></i><b>3</b> Overview of Essential Computing Skills</a></li>
<li class="chapter" data-level="4" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html"><i class="fa fa-check"></i><b>4</b> Essential Unix/Linux Terminal Knowledge</a><ul>
<li class="chapter" data-level="4.1" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#getting-a-bash-shell-on-your-system"><i class="fa fa-check"></i><b>4.1</b> Getting a bash shell on your system</a></li>
<li class="chapter" data-level="4.2" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#navigating-the-unix-filesystem"><i class="fa fa-check"></i><b>4.2</b> Navigating the Unix filesystem</a><ul>
<li class="chapter" data-level="4.2.1" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#changing-the-working-directory-with-cd"><i class="fa fa-check"></i><b>4.2.1</b> Changing the working directory with <code>cd</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#updating-your-command-prompt"><i class="fa fa-check"></i><b>4.2.2</b> Updating your command prompt</a></li>
<li class="chapter" data-level="4.2.3" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#tab-completion-for-paths"><i class="fa fa-check"></i><b>4.2.3</b> TAB-completion for paths</a></li>
<li class="chapter" data-level="4.2.4" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#listing-the-contents-of-a-directory-with-ls"><i class="fa fa-check"></i><b>4.2.4</b> Listing the contents of a directory with <code>ls</code></a></li>
<li class="chapter" data-level="4.2.5" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#globbing"><i class="fa fa-check"></i><b>4.2.5</b> Globbing</a></li>
<li class="chapter" data-level="4.2.6" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#what-makes-a-good-file-name"><i class="fa fa-check"></i><b>4.2.6</b> What makes a good file-name?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#the-anatomy-of-a-unix-command"><i class="fa fa-check"></i><b>4.3</b> The anatomy of a Unix command</a><ul>
<li class="chapter" data-level="4.3.1" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#anatomy-command"><i class="fa fa-check"></i><b>4.3.1</b> The <code>command</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#the-options"><i class="fa fa-check"></i><b>4.3.2</b> The <em>options</em></a></li>
<li class="chapter" data-level="4.3.3" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#arguments"><i class="fa fa-check"></i><b>4.3.3</b> Arguments</a></li>
<li class="chapter" data-level="4.3.4" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#getting-information-about-unix-commands"><i class="fa fa-check"></i><b>4.3.4</b> Getting information about Unix commands</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#handling-manipulating-and-viewing-files-and-streams"><i class="fa fa-check"></i><b>4.4</b> Handling, Manipulating, and Viewing files and streams</a><ul>
<li class="chapter" data-level="4.4.1" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#creating-new-directories"><i class="fa fa-check"></i><b>4.4.1</b> Creating new directories</a></li>
<li class="chapter" data-level="4.4.2" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#fundamental-file-handling-commands"><i class="fa fa-check"></i><b>4.4.2</b> Fundamental file-handling commands</a></li>
<li class="chapter" data-level="4.4.3" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#viewing-files"><i class="fa fa-check"></i><b>4.4.3</b> “Viewing” Files</a></li>
<li class="chapter" data-level="4.4.4" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#redirecting-standard-output-and"><i class="fa fa-check"></i><b>4.4.4</b> Redirecting standard output: <code>&gt;</code> and <code>&gt;&gt;</code></a></li>
<li class="chapter" data-level="4.4.5" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#stdin-and"><i class="fa fa-check"></i><b>4.4.5</b> stdin, <code>&lt;</code> and <code>|</code></a></li>
<li class="chapter" data-level="4.4.6" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#stderr"><i class="fa fa-check"></i><b>4.4.6</b> stderr</a></li>
<li class="chapter" data-level="4.4.7" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#symbolic-links"><i class="fa fa-check"></i><b>4.4.7</b> Symbolic links</a></li>
<li class="chapter" data-level="4.4.8" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#file-permissions"><i class="fa fa-check"></i><b>4.4.8</b> File Permissions</a></li>
<li class="chapter" data-level="4.4.9" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#editing-text-files-at-the-terminal"><i class="fa fa-check"></i><b>4.4.9</b> Editing text files at the terminal</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#unix-env"><i class="fa fa-check"></i><b>4.5</b> Customizing your Environment</a><ul>
<li class="chapter" data-level="4.5.1" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#appearances-matter"><i class="fa fa-check"></i><b>4.5.1</b> Appearances matter</a></li>
<li class="chapter" data-level="4.5.2" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#where-are-my-programscommands-at"><i class="fa fa-check"></i><b>4.5.2</b> Where are my programs/commands at?!</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#a-few-more-important-keystrokes"><i class="fa fa-check"></i><b>4.6</b> A Few More Important Keystrokes</a></li>
<li class="chapter" data-level="4.7" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#a-short-list-of-additional-useful-commands."><i class="fa fa-check"></i><b>4.7</b> A short list of additional useful commands.</a></li>
<li class="chapter" data-level="4.8" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#two-important-computing-concepts"><i class="fa fa-check"></i><b>4.8</b> Two important computing concepts</a><ul>
<li class="chapter" data-level="4.8.1" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#compression"><i class="fa fa-check"></i><b>4.8.1</b> Compression</a></li>
<li class="chapter" data-level="4.8.2" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#hashing"><i class="fa fa-check"></i><b>4.8.2</b> Hashing</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="essential-unixlinux-terminal-knowledge.html"><a href="essential-unixlinux-terminal-knowledge.html#unix-quick-study-guide"><i class="fa fa-check"></i><b>4.9</b> Unix: Quick Study Guide</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="shell-programming.html"><a href="shell-programming.html"><i class="fa fa-check"></i><b>5</b> Shell programming</a><ul>
<li class="chapter" data-level="5.1" data-path="shell-programming.html"><a href="shell-programming.html#an-example-script"><i class="fa fa-check"></i><b>5.1</b> An example script</a></li>
<li class="chapter" data-level="5.2" data-path="shell-programming.html"><a href="shell-programming.html#the-structure-of-a-bash-script"><i class="fa fa-check"></i><b>5.2</b> The Structure of a Bash Script</a><ul>
<li class="chapter" data-level="5.2.1" data-path="shell-programming.html"><a href="shell-programming.html#a-bit-more-on-and"><i class="fa fa-check"></i><b>5.2.1</b> A bit more on <code>;</code> and <code>&amp;</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="shell-programming.html"><a href="shell-programming.html#variables"><i class="fa fa-check"></i><b>5.3</b> Variables</a><ul>
<li class="chapter" data-level="5.3.1" data-path="shell-programming.html"><a href="shell-programming.html#assigning-values-to-variables"><i class="fa fa-check"></i><b>5.3.1</b> Assigning values to variables</a></li>
<li class="chapter" data-level="5.3.2" data-path="shell-programming.html"><a href="shell-programming.html#accessing-values-from-variables"><i class="fa fa-check"></i><b>5.3.2</b> Accessing values from variables</a></li>
<li class="chapter" data-level="5.3.3" data-path="shell-programming.html"><a href="shell-programming.html#what-does-the-shell-do-with-the-value-substituted-for-a-variable"><i class="fa fa-check"></i><b>5.3.3</b> What does the shell do with the value substituted for a variable?</a></li>
<li class="chapter" data-level="5.3.4" data-path="shell-programming.html"><a href="shell-programming.html#double-and-single-quotation-marks-and-variable-substitution"><i class="fa fa-check"></i><b>5.3.4</b> Double and Single Quotation Marks and Variable Substitution</a></li>
<li class="chapter" data-level="5.3.5" data-path="shell-programming.html"><a href="shell-programming.html#one-useful-fancy-variable-substitution-method"><i class="fa fa-check"></i><b>5.3.5</b> One useful, fancy, variable-substitution method</a></li>
<li class="chapter" data-level="5.3.6" data-path="shell-programming.html"><a href="shell-programming.html#variable-arrays"><i class="fa fa-check"></i><b>5.3.6</b> Variable arrays</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="shell-programming.html"><a href="shell-programming.html#evaluate-a-command-and-substitute-the-result-on-the-command-line"><i class="fa fa-check"></i><b>5.4</b> Evaluate a command and substitute the result on the command line</a></li>
<li class="chapter" data-level="5.5" data-path="shell-programming.html"><a href="shell-programming.html#groupingcollecting-output-from-multiple-commands-commands-and-commands"><i class="fa fa-check"></i><b>5.5</b> Grouping/Collecting output from multiple commands: <code>(commands)</code> and <code>{ commands; }</code></a></li>
<li class="chapter" data-level="5.6" data-path="shell-programming.html"><a href="shell-programming.html#exit-status"><i class="fa fa-check"></i><b>5.6</b> Exit Status</a><ul>
<li class="chapter" data-level="5.6.1" data-path="shell-programming.html"><a href="shell-programming.html#combinations-of-exit-statuses"><i class="fa fa-check"></i><b>5.6.1</b> Combinations of exit statuses</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="shell-programming.html"><a href="shell-programming.html#loops-and-repetition"><i class="fa fa-check"></i><b>5.7</b> Loops and repetition</a></li>
<li class="chapter" data-level="5.8" data-path="shell-programming.html"><a href="shell-programming.html#more-conditional-evaluation-if-then-else-and-friends"><i class="fa fa-check"></i><b>5.8</b> More Conditional Evaluation: <code>if</code>, <code>then</code>, <code>else</code>, and friends</a></li>
<li class="chapter" data-level="5.9" data-path="shell-programming.html"><a href="shell-programming.html#finallypositional-parameters"><i class="fa fa-check"></i><b>5.9</b> Finally…positional parameters</a></li>
<li class="chapter" data-level="5.10" data-path="shell-programming.html"><a href="shell-programming.html#basename-and-dirname-two-useful-little-utilities"><i class="fa fa-check"></i><b>5.10</b> <code>basename</code> and <code>dirname</code> two useful little utilities</a></li>
<li class="chapter" data-level="5.11" data-path="shell-programming.html"><a href="shell-programming.html#bash-functions"><i class="fa fa-check"></i><b>5.11</b> <code>bash</code> functions</a></li>
<li class="chapter" data-level="5.12" data-path="shell-programming.html"><a href="shell-programming.html#reading-files-line-by-line"><i class="fa fa-check"></i><b>5.12</b> reading files line by line</a></li>
<li class="chapter" data-level="5.13" data-path="shell-programming.html"><a href="shell-programming.html#further-reading"><i class="fa fa-check"></i><b>5.13</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html"><i class="fa fa-check"></i><b>6</b> Sed, awk, and regular expressions</a><ul>
<li class="chapter" data-level="6.1" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#awk"><i class="fa fa-check"></i><b>6.1</b> awk</a><ul>
<li class="chapter" data-level="6.1.1" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#line-cycling-tests-and-actions"><i class="fa fa-check"></i><b>6.1.1</b> Line-cycling, tests and actions</a></li>
<li class="chapter" data-level="6.1.2" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#column-splitting-fields--f-nf-print-ofs-and-begin"><i class="fa fa-check"></i><b>6.1.2</b> Column splitting, fields, <code>-F</code>, <code>$</code>, <code>NF</code>, <code>print</code>, <code>OFS</code> and <code>BEGIN</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#a-brief-introduction-to-regular-expressions"><i class="fa fa-check"></i><b>6.1.3</b> A brief introduction to regular expressions</a></li>
<li class="chapter" data-level="6.1.4" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#a-variety-of-tests"><i class="fa fa-check"></i><b>6.1.4</b> A variety of tests</a></li>
<li class="chapter" data-level="6.1.5" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#code-in-the-action-blocks"><i class="fa fa-check"></i><b>6.1.5</b> Code in the action blocks</a></li>
<li class="chapter" data-level="6.1.6" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#using-awk-to-assign-to-shell-variables"><i class="fa fa-check"></i><b>6.1.6</b> Using <code>awk</code> to assign to shell variables</a></li>
<li class="chapter" data-level="6.1.7" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#passing-variables-into-awk-with--v"><i class="fa fa-check"></i><b>6.1.7</b> Passing Variables into <code>awk</code> with <code>-v</code></a></li>
<li class="chapter" data-level="6.1.8" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#writing-awk-scripts-in-files"><i class="fa fa-check"></i><b>6.1.8</b> Writing awk scripts in files</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sed-awk-and-regular-expressions.html"><a href="sed-awk-and-regular-expressions.html#sed"><i class="fa fa-check"></i><b>6.2</b> sed</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html"><i class="fa fa-check"></i><b>7</b> Working on remote servers</a><ul>
<li class="chapter" data-level="7.1" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#accessing-remote-computers"><i class="fa fa-check"></i><b>7.1</b> Accessing remote computers</a><ul>
<li class="chapter" data-level="7.1.1" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#windows"><i class="fa fa-check"></i><b>7.1.1</b> Windows</a></li>
<li class="chapter" data-level="7.1.2" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#hummingbird"><i class="fa fa-check"></i><b>7.1.2</b> Hummingbird</a></li>
<li class="chapter" data-level="7.1.3" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#summit"><i class="fa fa-check"></i><b>7.1.3</b> Summit</a></li>
<li class="chapter" data-level="7.1.4" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#sedna"><i class="fa fa-check"></i><b>7.1.4</b> Sedna</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#transferring-files-to-remote-computers"><i class="fa fa-check"></i><b>7.2</b> Transferring files to remote computers</a><ul>
<li class="chapter" data-level="7.2.1" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#sftp-via-lftp"><i class="fa fa-check"></i><b>7.2.1</b> <code>sftp</code> (via <code>lftp</code>)</a></li>
<li class="chapter" data-level="7.2.2" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#git"><i class="fa fa-check"></i><b>7.2.2</b> git</a></li>
<li class="chapter" data-level="7.2.3" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#globus"><i class="fa fa-check"></i><b>7.2.3</b> Globus</a></li>
<li class="chapter" data-level="7.2.4" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#interfacing-with-the-cloud"><i class="fa fa-check"></i><b>7.2.4</b> Interfacing with “The Cloud”</a></li>
<li class="chapter" data-level="7.2.5" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#getting-files-from-a-sequencing-center"><i class="fa fa-check"></i><b>7.2.5</b> Getting files from a sequencing center</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#tmux"><i class="fa fa-check"></i><b>7.3</b> <code>tmux</code>: the terminal multiplexer</a><ul>
<li class="chapter" data-level="7.3.1" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#an-analogy-for-how-tmux-works"><i class="fa fa-check"></i><b>7.3.1</b> An analogy for how <code>tmux</code> works</a></li>
<li class="chapter" data-level="7.3.2" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#first-steps-with-tmux"><i class="fa fa-check"></i><b>7.3.2</b> First steps with <code>tmux</code></a></li>
<li class="chapter" data-level="7.3.3" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#further-steps-with-tmux"><i class="fa fa-check"></i><b>7.3.3</b> Further steps with <code>tmux</code></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#tmux-for-mac-users"><i class="fa fa-check"></i><b>7.4</b> <code>tmux</code> for Mac users</a></li>
<li class="chapter" data-level="7.5" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#vim-its-time-to-get-serious-with-text-editing"><i class="fa fa-check"></i><b>7.5</b> <code>vim</code>: it’s time to get serious with text editing</a><ul>
<li class="chapter" data-level="7.5.1" data-path="working-on-remote-servers.html"><a href="working-on-remote-servers.html#using-neovim-and-nvim-r-and-tmux-to-use-r-well-on-the-cluster"><i class="fa fa-check"></i><b>7.5.1</b> Using neovim and Nvim-R and tmux to use R well on the cluster</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html"><i class="fa fa-check"></i><b>8</b> High Performance Computing Clusters (HPCC’s)</a><ul>
<li class="chapter" data-level="8.1" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#an-oversimplified-but-useful-view-of-a-computing-cluster"><i class="fa fa-check"></i><b>8.1</b> An oversimplified, but useful, view of a computing cluster</a></li>
<li class="chapter" data-level="8.2" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#cluster-computing-and-the-job-scheduler"><i class="fa fa-check"></i><b>8.2</b> Cluster computing and the job scheduler</a></li>
<li class="chapter" data-level="8.3" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#learning-about-the-resources-on-your-hpcc"><i class="fa fa-check"></i><b>8.3</b> Learning about the resources on your HPCC</a></li>
<li class="chapter" data-level="8.4" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#installing-software-on-an-hpcc"><i class="fa fa-check"></i><b>8.4</b> Installing Software on an HPCC</a><ul>
<li class="chapter" data-level="8.4.1" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#miniconda"><i class="fa fa-check"></i><b>8.4.1</b> Miniconda</a></li>
<li class="chapter" data-level="8.4.2" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#modules"><i class="fa fa-check"></i><b>8.4.2</b> Modules</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#getting-compute-resources-allocated-to-your-jobs-on-an-hpcc"><i class="fa fa-check"></i><b>8.5</b> Getting compute resources allocated to your jobs on an HPCC</a><ul>
<li class="chapter" data-level="8.5.1" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#interactive-sessions"><i class="fa fa-check"></i><b>8.5.1</b> Interactive sessions</a></li>
<li class="chapter" data-level="8.5.2" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#an-in-class-exercise-to-make-sure-everything-is-configured-correctly"><i class="fa fa-check"></i><b>8.5.2</b> An in-class exercise to make sure everything is configured correctly</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#more-boneyard"><i class="fa fa-check"></i><b>8.6</b> More Boneyard…</a></li>
<li class="chapter" data-level="8.7" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#the-queue-slurmsgeuge"><i class="fa fa-check"></i><b>8.7</b> The Queue (SLURM/SGE/UGE)</a></li>
<li class="chapter" data-level="8.8" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#modules-package"><i class="fa fa-check"></i><b>8.8</b> Modules package</a></li>
<li class="chapter" data-level="8.9" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#compiling-programs-without-admin-privileges"><i class="fa fa-check"></i><b>8.9</b> Compiling programs without admin privileges</a></li>
<li class="chapter" data-level="8.10" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#job-arrays"><i class="fa fa-check"></i><b>8.10</b> Job arrays</a></li>
<li class="chapter" data-level="8.11" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#writing-stdout-and-stderr-to-files"><i class="fa fa-check"></i><b>8.11</b> Writing stdout and stderr to files</a></li>
<li class="chapter" data-level="8.12" data-path="high-performance-computing-clusters-hpccs.html"><a href="high-performance-computing-clusters-hpccs.html#breaking-stuff-down"><i class="fa fa-check"></i><b>8.12</b> Breaking stuff down</a></li>
</ul></li>
<li class="part"><span><b>II Part II: Reproducible Research Strategies</b></span></li>
<li class="chapter" data-level="9" data-path="introduction-to-reproducible-research.html"><a href="introduction-to-reproducible-research.html"><i class="fa fa-check"></i><b>9</b> Introduction to Reproducible Research</a></li>
<li class="chapter" data-level="10" data-path="rstudio-and-project-centered-organization.html"><a href="rstudio-and-project-centered-organization.html"><i class="fa fa-check"></i><b>10</b> Rstudio and Project-centered Organization</a><ul>
<li class="chapter" data-level="10.1" data-path="rstudio-and-project-centered-organization.html"><a href="rstudio-and-project-centered-organization.html#organizing-big-projects"><i class="fa fa-check"></i><b>10.1</b> Organizing big projects</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>11</b> Version control</a><ul>
<li class="chapter" data-level="11.1" data-path="version-control.html"><a href="version-control.html#why-use-version-control"><i class="fa fa-check"></i><b>11.1</b> Why use version control?</a></li>
<li class="chapter" data-level="11.2" data-path="version-control.html"><a href="version-control.html#git-workings"><i class="fa fa-check"></i><b>11.2</b> How git works</a></li>
<li class="chapter" data-level="11.3" data-path="version-control.html"><a href="version-control.html#git-workflow-patterns"><i class="fa fa-check"></i><b>11.3</b> git workflow patterns</a></li>
<li class="chapter" data-level="11.4" data-path="version-control.html"><a href="version-control.html#using-git-with-rstudio"><i class="fa fa-check"></i><b>11.4</b> using git with Rstudio</a></li>
<li class="chapter" data-level="11.5" data-path="version-control.html"><a href="version-control.html#git-on-the-command-line"><i class="fa fa-check"></i><b>11.5</b> git on the command line</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="a-fast-furious-overview-of-the-tidyverse.html"><a href="a-fast-furious-overview-of-the-tidyverse.html"><i class="fa fa-check"></i><b>12</b> A fast, furious overview of the tidyverse</a></li>
<li class="chapter" data-level="13" data-path="authoring-reproducibly-with-rmarkdown.html"><a href="authoring-reproducibly-with-rmarkdown.html"><i class="fa fa-check"></i><b>13</b> Authoring reproducibly with Rmarkdown</a><ul>
<li class="chapter" data-level="13.1" data-path="authoring-reproducibly-with-rmarkdown.html"><a href="authoring-reproducibly-with-rmarkdown.html#notebooks"><i class="fa fa-check"></i><b>13.1</b> Notebooks</a></li>
<li class="chapter" data-level="13.2" data-path="authoring-reproducibly-with-rmarkdown.html"><a href="authoring-reproducibly-with-rmarkdown.html#references"><i class="fa fa-check"></i><b>13.2</b> References</a><ul>
<li class="chapter" data-level="13.2.1" data-path="authoring-reproducibly-with-rmarkdown.html"><a href="authoring-reproducibly-with-rmarkdown.html#zotero-and-rmarkdown"><i class="fa fa-check"></i><b>13.2.1</b> Zotero and Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="authoring-reproducibly-with-rmarkdown.html"><a href="authoring-reproducibly-with-rmarkdown.html#bookdown"><i class="fa fa-check"></i><b>13.3</b> Bookdown</a></li>
<li class="chapter" data-level="13.4" data-path="authoring-reproducibly-with-rmarkdown.html"><a href="authoring-reproducibly-with-rmarkdown.html#google-docs"><i class="fa fa-check"></i><b>13.4</b> Google Docs</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="using-python.html"><a href="using-python.html"><i class="fa fa-check"></i><b>14</b> Using python</a></li>
<li class="part"><span><b>III Part III: Bioinformatic Analyses</b></span></li>
<li class="chapter" data-level="15" data-path="overview-of-bioinformatic-analyses.html"><a href="overview-of-bioinformatic-analyses.html"><i class="fa fa-check"></i><b>15</b> Overview of Bioinformatic Analyses</a></li>
<li class="chapter" data-level="16" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html"><i class="fa fa-check"></i><b>16</b> DNA Sequences and Sequencing</a><ul>
<li class="chapter" data-level="16.1" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#dna-stuff"><i class="fa fa-check"></i><b>16.1</b> DNA Stuff</a><ul>
<li class="chapter" data-level="16.1.1" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#dna-replication-with-dna-polymerase"><i class="fa fa-check"></i><b>16.1.1</b> DNA Replication with DNA Polymerase</a></li>
<li class="chapter" data-level="16.1.2" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#the-importance-of-the-3-hydroxyl"><i class="fa fa-check"></i><b>16.1.2</b> The importance of the 3’ hydroxyl…</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#sanger-sequencing"><i class="fa fa-check"></i><b>16.2</b> Sanger sequencing</a></li>
<li class="chapter" data-level="16.3" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#illumina-sequencing-by-synthesis"><i class="fa fa-check"></i><b>16.3</b> Illumina Sequencing by Synthesis</a></li>
<li class="chapter" data-level="16.4" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#library-prep-protocols"><i class="fa fa-check"></i><b>16.4</b> Library Prep Protocols</a><ul>
<li class="chapter" data-level="16.4.1" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#wgs"><i class="fa fa-check"></i><b>16.4.1</b> WGS</a></li>
<li class="chapter" data-level="16.4.2" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#rad-seq-methods"><i class="fa fa-check"></i><b>16.4.2</b> RAD-Seq methods</a></li>
<li class="chapter" data-level="16.4.3" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#amplicon-sequencing"><i class="fa fa-check"></i><b>16.4.3</b> Amplicon Sequencing</a></li>
<li class="chapter" data-level="16.4.4" data-path="dna-sequences-and-sequencing.html"><a href="dna-sequences-and-sequencing.html#capture-arrays-rapture-etc."><i class="fa fa-check"></i><b>16.4.4</b> Capture arrays, RAPTURE, etc.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html"><i class="fa fa-check"></i><b>17</b> Bioinformatic file formats</a><ul>
<li class="chapter" data-level="17.1" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#sequences"><i class="fa fa-check"></i><b>17.1</b> Sequences</a></li>
<li class="chapter" data-level="17.2" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#fastq"><i class="fa fa-check"></i><b>17.2</b> FASTQ</a><ul>
<li class="chapter" data-level="17.2.1" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#line-1-illumina-identifier-lines"><i class="fa fa-check"></i><b>17.2.1</b> Line 1: Illumina identifier lines</a></li>
<li class="chapter" data-level="17.2.2" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#line-4-base-quality-scores"><i class="fa fa-check"></i><b>17.2.2</b> Line 4: Base quality scores</a></li>
<li class="chapter" data-level="17.2.3" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#a-fastq-tidyverse-interlude"><i class="fa fa-check"></i><b>17.2.3</b> A FASTQ ‘tidyverse’ Interlude</a></li>
<li class="chapter" data-level="17.2.4" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#comparing-read-1-to-read-2"><i class="fa fa-check"></i><b>17.2.4</b> Comparing read 1 to read 2</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#fasta"><i class="fa fa-check"></i><b>17.3</b> FASTA</a><ul>
<li class="chapter" data-level="17.3.1" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#genomic-ranges"><i class="fa fa-check"></i><b>17.3.1</b> Genomic ranges</a></li>
<li class="chapter" data-level="17.3.2" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#extracting-genomic-ranges-from-a-fasta-file"><i class="fa fa-check"></i><b>17.3.2</b> Extracting genomic ranges from a FASTA file</a></li>
<li class="chapter" data-level="17.3.3" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#downloading-reference-genomes-from-ncbi"><i class="fa fa-check"></i><b>17.3.3</b> Downloading reference genomes from NCBI</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#alignments"><i class="fa fa-check"></i><b>17.4</b> Alignments</a><ul>
<li class="chapter" data-level="17.4.1" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#how-might-i-align-to-thee-let-me-count-the-ways"><i class="fa fa-check"></i><b>17.4.1</b> How might I align to thee? Let me count the ways…</a></li>
<li class="chapter" data-level="17.4.2" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#play-with-simple-alignments"><i class="fa fa-check"></i><b>17.4.2</b> Play with simple alignments</a></li>
<li class="chapter" data-level="17.4.3" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#sam-flags"><i class="fa fa-check"></i><b>17.4.3</b> SAM Flags</a></li>
<li class="chapter" data-level="17.4.4" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#the-cigar-string"><i class="fa fa-check"></i><b>17.4.4</b> The CIGAR string</a></li>
<li class="chapter" data-level="17.4.5" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#the-seq-and-qual-columns"><i class="fa fa-check"></i><b>17.4.5</b> The SEQ and QUAL columns</a></li>
<li class="chapter" data-level="17.4.6" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#sam-file-headers"><i class="fa fa-check"></i><b>17.4.6</b> SAM File Headers</a></li>
<li class="chapter" data-level="17.4.7" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#the-bam-format"><i class="fa fa-check"></i><b>17.4.7</b> The BAM format</a></li>
<li class="chapter" data-level="17.4.8" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#quick-self-study"><i class="fa fa-check"></i><b>17.4.8</b> Quick self study</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#variants"><i class="fa fa-check"></i><b>17.5</b> Variants</a></li>
<li class="chapter" data-level="17.6" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#segments"><i class="fa fa-check"></i><b>17.6</b> Segments</a></li>
<li class="chapter" data-level="17.7" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#conversionextractions-between-different-formats"><i class="fa fa-check"></i><b>17.7</b> Conversion/Extractions between different formats</a></li>
<li class="chapter" data-level="17.8" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#visualization-of-genomic-data"><i class="fa fa-check"></i><b>17.8</b> Visualization of Genomic Data</a><ul>
<li class="chapter" data-level="17.8.1" data-path="bioinformatic-file-formats.html"><a href="bioinformatic-file-formats.html#sample-data"><i class="fa fa-check"></i><b>17.8.1</b> Sample Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="genome-assembly.html"><a href="genome-assembly.html"><i class="fa fa-check"></i><b>18</b> Genome Assembly</a></li>
<li class="chapter" data-level="19" data-path="alignment-of-sequence-data-to-a-reference-genome.html"><a href="alignment-of-sequence-data-to-a-reference-genome.html"><i class="fa fa-check"></i><b>19</b> Alignment of sequence data to a reference genome</a><ul>
<li class="chapter" data-level="19.1" data-path="alignment-of-sequence-data-to-a-reference-genome.html"><a href="alignment-of-sequence-data-to-a-reference-genome.html#preprocess"><i class="fa fa-check"></i><b>19.1</b> Preprocess ?</a></li>
<li class="chapter" data-level="19.2" data-path="alignment-of-sequence-data-to-a-reference-genome.html"><a href="alignment-of-sequence-data-to-a-reference-genome.html#read-groups"><i class="fa fa-check"></i><b>19.2</b> Read Groups</a></li>
<li class="chapter" data-level="19.3" data-path="alignment-of-sequence-data-to-a-reference-genome.html"><a href="alignment-of-sequence-data-to-a-reference-genome.html#merging-bam-files"><i class="fa fa-check"></i><b>19.3</b> Merging BAM files</a></li>
<li class="chapter" data-level="19.4" data-path="alignment-of-sequence-data-to-a-reference-genome.html"><a href="alignment-of-sequence-data-to-a-reference-genome.html#divide-and-conquer-strategies"><i class="fa fa-check"></i><b>19.4</b> Divide and Conquer Strategies</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="variant-calling-with-gatk.html"><a href="variant-calling-with-gatk.html"><i class="fa fa-check"></i><b>20</b> Variant calling with GATK</a></li>
<li class="chapter" data-level="21" data-path="bioinformatics-for-rad-seq-data-with-and-without-a-reference-genome.html"><a href="bioinformatics-for-rad-seq-data-with-and-without-a-reference-genome.html"><i class="fa fa-check"></i><b>21</b> Bioinformatics for RAD seq data with and without a reference genome</a></li>
<li class="chapter" data-level="22" data-path="processing-amplicon-sequencing-data.html"><a href="processing-amplicon-sequencing-data.html"><i class="fa fa-check"></i><b>22</b> Processing amplicon sequencing data</a></li>
<li class="chapter" data-level="23" data-path="genome-annotation.html"><a href="genome-annotation.html"><i class="fa fa-check"></i><b>23</b> Genome Annotation</a></li>
<li class="chapter" data-level="24" data-path="whole-genome-alignment-strategies.html"><a href="whole-genome-alignment-strategies.html"><i class="fa fa-check"></i><b>24</b> Whole genome alignment strategies</a><ul>
<li class="chapter" data-level="24.1" data-path="whole-genome-alignment-strategies.html"><a href="whole-genome-alignment-strategies.html#mapping-of-scaffolds-to-a-closely-related-genome"><i class="fa fa-check"></i><b>24.1</b> Mapping of scaffolds to a closely related genome</a></li>
<li class="chapter" data-level="24.2" data-path="whole-genome-alignment-strategies.html"><a href="whole-genome-alignment-strategies.html#obtaining-ancestral-states-from-an-outgroup-genome"><i class="fa fa-check"></i><b>24.2</b> Obtaining Ancestral States from an Outgroup Genome</a><ul>
<li class="chapter" data-level="24.2.1" data-path="whole-genome-alignment-strategies.html"><a href="whole-genome-alignment-strategies.html#using-lastz-to-align-coho-to-the-chinook-genome"><i class="fa fa-check"></i><b>24.2.1</b> Using LASTZ to align coho to the chinook genome</a></li>
<li class="chapter" data-level="24.2.2" data-path="whole-genome-alignment-strategies.html"><a href="whole-genome-alignment-strategies.html#try-on-the-chinook-chromosomes"><i class="fa fa-check"></i><b>24.2.2</b> Try on the chinook chromosomes</a></li>
<li class="chapter" data-level="24.2.3" data-path="whole-genome-alignment-strategies.html"><a href="whole-genome-alignment-strategies.html#explore-the-other-parameters-more"><i class="fa fa-check"></i><b>24.2.3</b> Explore the other parameters more</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Part IV: Analysis of Big Variant Data</b></span></li>
<li class="chapter" data-level="25" data-path="bioinformatic-analysis-on-variant-data.html"><a href="bioinformatic-analysis-on-variant-data.html"><i class="fa fa-check"></i><b>25</b> Bioinformatic analysis on variant data</a></li>
<li class="part"><span><b>V Part V: Population Genomics</b></span></li>
<li class="chapter" data-level="26" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html"><i class="fa fa-check"></i><b>26</b> Topics in pop gen</a><ul>
<li class="chapter" data-level="26.1" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html#coalescent"><i class="fa fa-check"></i><b>26.1</b> Coalescent</a></li>
<li class="chapter" data-level="26.2" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html#measures-of-genetic-diversity-and-such"><i class="fa fa-check"></i><b>26.2</b> Measures of genetic diversity and such</a></li>
<li class="chapter" data-level="26.3" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html#demographic-inference-with-partial-a-partial-i-and-moments"><i class="fa fa-check"></i><b>26.3</b> Demographic inference with <span class="math inline">\(\partial a \partial i\)</span> and <em>moments</em></a></li>
<li class="chapter" data-level="26.4" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html#balls-in-boxes"><i class="fa fa-check"></i><b>26.4</b> Balls in Boxes</a></li>
<li class="chapter" data-level="26.5" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html#some-landscape-genetics"><i class="fa fa-check"></i><b>26.5</b> Some landscape genetics</a></li>
<li class="chapter" data-level="26.6" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html#relationship-inference"><i class="fa fa-check"></i><b>26.6</b> Relationship Inference</a></li>
<li class="chapter" data-level="26.7" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html#tests-for-selection"><i class="fa fa-check"></i><b>26.7</b> Tests for Selection</a></li>
<li class="chapter" data-level="26.8" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html#multivariate-associations-gea-etc."><i class="fa fa-check"></i><b>26.8</b> Multivariate Associations, GEA, etc.</a></li>
<li class="chapter" data-level="26.9" data-path="topics-in-pop-gen.html"><a href="topics-in-pop-gen.html#estimating-heritability-in-the-wild"><i class="fa fa-check"></i><b>26.9</b> Estimating heritability in the wild</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Practical Computing and Bioinformatics for Conservation and Evolutionary Genomics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sed-awk-and-regular-expressions" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Sed, awk, and regular expressions</h1>
<p>In the course of doing bioinformatics, you will be dealing with myriad different
<em>text</em> files. As we noted in the previous chapters, Unix, with its file I/O model,
piping capabilities, and numerous utilities, is well-suited to handling
large text files. Two utilities found on every Unix installation—<code>awk</code> and <code>sed</code>—merit
special attention in this context. <code>awk</code> is a lightweight scripting language that lets
you write succinct programs to operate line-by-by line on the contents of text files. It is
particularly useful for handling text files that have columns of data separated by white spaces
or tabs. <code>sed</code> on the other hand, is particularly useful for automating
“find-and-replace” operations on text files. Each of them is optimized to
handle large files without storing a lot of information in memory, so they can be
useful for quick operations on large bioinformatic data sets. Neither is a fully-featured
programming language that you would want to write large, complex programs in (that said,
I did once implement a complete program for full-sibling inference from multiallelic markers
in <code>awk</code>); however they do share many of the
useful text-manipulation capabilities of such languages, such as Perl and Python. Additionally,
<code>awk</code> and <code>sed</code> are deployed in a consistent fashion across most Unix operating systems, and they
don’t require much time to learn to use effectively for common text-processing tasks.
As a consequence <code>awk</code> and <code>sed</code> are a useful addition to the bioinformatician’s toolbox.</p>
<p>Both <code>awk</code> and <code>sed</code> rely heavily on <em>regular expressions</em> to describe <em>patterns</em>
in text upon which some operation should be performed. You can think of
regular expressions as providing a succinct language for performing very advanced “find”
and “find-and-replace” operations
in a text file.</p>
<p>In this chapter we will only scratch the surface of what can be done with <code>awk</code> and <code>sed</code>. Indeed,
there is an entire <a href="http://shop.oreilly.com/product/9781565922259.do">432-page book</a> published decades
ago by O’Reilly about <code>awk</code> and <code>sed</code>. Our goal here is to provide an introduction to a few basic
maneuvers with both <code>awk</code> and <code>sed</code> and to describe instances where they can be useful, as well as
to give an introduction to many (but certainly not all) of the patterns that can be expressed
using regular expressions. We will start with a basic overview of how <code>awk</code> works. Then we will
have a short look at regular expressions, then we will use those further in <code>awk</code>, and finally we
will play with <code>sed</code> a little bit.</p>
<p>In order to have a set of files to use in the examples, I have made a small GitHub
repository called <code>awk-and-sed-inputs</code>. You can get that with</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb138-1" data-line-number="1"><span class="fu">git</span> clone https://github.com/eriqande/awk-and-sed-inputs</a></code></pre></div>
<p>All of the examples in this chapter that use such external files
assume that the current working directory is
the repository directory <code>awk-and-sed-inputs</code>.</p>
<div id="awk" class="section level2">
<h2><span class="header-section-number">6.1</span> awk</h2>
<div id="line-cycling-tests-and-actions" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Line-cycling, tests and actions</h3>
<p><code>awk</code> operates by cycling through a file (or an input stream from <em>stdin</em>) line-by-line. At each
new line <code>awk</code> tests whether it should do anything with the contents of the line. If the answer
to that test is “yes”, then it executes the code that describes what should be done to the
contents of the line. The scope of ways that <code>awk</code> can operate on text is quite wide, but,
the most common use of <code>awk</code> is to print parts of the line, or do small calculations on parts of the
line. The instructions that describe the tests and the actions are included in the <code>awk</code> “script”, though,
in practice, this script is often given to <code>awk</code> not as a file, but, rather, as text between single-quotes on the
command line. The basic syntax looks like this:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb139-1" data-line-number="1"><span class="ex">%</span> awk <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb139-2" data-line-number="2"><span class="st">  test1  {action1}</span></a>
<a class="sourceLine" id="cb139-3" data-line-number="3"><span class="st">  test2  {action2}</span></a>
<a class="sourceLine" id="cb139-4" data-line-number="4"><span class="st">&#39;</span> file</a></code></pre></div>
<p>Where <code>file</code> is the path of the file you want <code>awk</code> to read, and the “tests” and “actions”
above are just placeholders showing where those parts of the script are written. The layout
makes it clear that if <code>test1</code> is TRUE, <code>action1</code> will be executed, and if <code>test2</code> is TRUE, then
<code>action2</code> is executed. Code describing the actions must always appear within a set of
curly braces. We will refer to the text within those curly braces as an <em>action block</em>.</p>
<p>Two things to note: first, different tests and actions do not have to be written on separate lines. That makes
things easier to read, but if you are writing these short scripts on the command line, it is often
easier to put everything on a single line, like <code>'test1  {action1} test2  {action2}</code>, and that is fine.
Second, if you don’t supply a file path to <code>awk</code> it expects (and gladly processes) data from <em>stdin</em>.<br />
This makes it easy to pipe data into <code>awk</code>. For example, putting the above two points together,
the above <code>awk</code> script skeleton could
have been written this way:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb140-1" data-line-number="1"><span class="ex">%</span> cat file <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;test1  {action1} test2  {action2}&#39;</span></a></code></pre></div>
<p>Before we get too abstract talking about tests and actions, let’s look at a few
examples:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb141-1" data-line-number="1"><span class="co"># print lines starting with @SQ in the SAM header of a file</span></a>
<a class="sourceLine" id="cb141-2" data-line-number="2"><span class="fu">awk</span> <span class="st">&#39;/^@SQ/ {print}&#39;</span> data/DPCh_plate1_F12_S72.sam</a>
<a class="sourceLine" id="cb141-3" data-line-number="3"></a>
<a class="sourceLine" id="cb141-4" data-line-number="4"><span class="co"># print only those @SQ lines with a sequence name tag starting with &quot;NC_&quot;</span></a>
<a class="sourceLine" id="cb141-5" data-line-number="5"><span class="fu">awk</span> <span class="st">&#39;/^@SQ/ &amp;&amp; /SN:NC_/ {print}&#39;</span> data/DPCh_plate1_F12_S72.sam</a>
<a class="sourceLine" id="cb141-6" data-line-number="6"></a>
<a class="sourceLine" id="cb141-7" data-line-number="7"><span class="co"># same as above, but quit processing the file as soon as you hit</span></a>
<a class="sourceLine" id="cb141-8" data-line-number="8"><span class="co"># an @SQ line with a sequence name starting with &quot;NW_&quot;</span></a>
<a class="sourceLine" id="cb141-9" data-line-number="9"><span class="fu">awk</span> <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb141-10" data-line-number="10"><span class="st">  /^@SQ/ &amp;&amp; /SN:NC_/ {print}</span></a>
<a class="sourceLine" id="cb141-11" data-line-number="11"><span class="st">  /^@SQ/ &amp;&amp; /SN:NW_/ {exit}  </span></a>
<a class="sourceLine" id="cb141-12" data-line-number="12"><span class="st">&#39;</span> data/DPCh_plate1_F12_S72.sam</a>
<a class="sourceLine" id="cb141-13" data-line-number="13"></a>
<a class="sourceLine" id="cb141-14" data-line-number="14"></a>
<a class="sourceLine" id="cb141-15" data-line-number="15"><span class="co"># print only lines 101, and 103 from the fastq file</span></a>
<a class="sourceLine" id="cb141-16" data-line-number="16"><span class="ex">gzcat</span> data/DPCh_plate1_F12_S72.R1.fq.gz <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;NR==101 || NR==102 {print}&#39;</span></a></code></pre></div>
<p>The above examples show only two different actions (<code>print</code> and <code>exit</code>) and
a variety of tests based on matching substrings in each line, or on which
line number (<code>NR</code>, which stands for “number of the record”).</p>
<p>Take a moment to make sure you understand which parts are the tests, and which are the actions
in the above examples.</p>
</div>
<div id="column-splitting-fields--f-nf-print-ofs-and-begin" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Column splitting, fields, <code>-F</code>, <code>$</code>, <code>NF</code>, <code>print</code>, <code>OFS</code> and <code>BEGIN</code></h3>
<p>Every time <code>awk</code> processes a line of text it breaks it into different <em>fields</em>, which you
can think of as columns (as in a spreadsheet). By default, any number of whitespace (space or TAB)
characters constitutes a break between columns. If you want field-splitting to be done using
more specific characters, you can specify that on the command line with the the <code>-F</code> option.
For example:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="fu">awk</span> -F<span class="st">&quot;\t&quot;</span> <span class="st">&#39;test {action}&#39;</span> file  # split lines into fields on single TAB characters</a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="fu">awk</span> -F<span class="st">&quot;,&quot;</span> <span class="st">&#39;test {action}&#39;</span> file  # split lines into fields on single commas</a>
<a class="sourceLine" id="cb142-3" data-line-number="3"><span class="fu">awk</span> -F<span class="st">&quot;:&quot;</span> <span class="st">&#39;test {action}&#39;</span> file  # split lines into fields on single colons</a>
<a class="sourceLine" id="cb142-4" data-line-number="4"><span class="fu">awk</span> -F<span class="st">&quot;;&quot;</span> <span class="st">&#39;test {action}&#39;</span> file  # split lines into fields on single semicolons</a>
<a class="sourceLine" id="cb142-5" data-line-number="5"><span class="co"># and so forth...</span></a></code></pre></div>
<p>While in all those examples, the field separator is a single character, in full-blown
practice, the field separator can be specified as a <em>regular expression</em> (see below).</p>
<p>Within an action block, you can access the different fields that <code>awk</code> has split out
of the line using a <code>$</code> followed immediately by a field number, i.e., <code>$1</code>, <code>$2</code>, <code>$3</code>, … . When you get
to fields with indexes greater than 9, you have to wrap the number in parentheses, like
<code>$(10)</code>, <code>$(11)</code>,… . The special value <code>$0</code> denotes the whole line, not just one of its
fields. (Note that if you give the action <code>print</code> without any arguments, that also just
prints the whole line.) The special variable <code>NF</code> is the “Number of Fields”, so
<code>$NF</code> is the “last column.”</p>
<p>Let’s say we have a tab-separated file in <code>data/wgs-chinook-samples.tsv</code> that looks like this:</p>
<pre><code>vcf_name    ID_Berk NMFS_DNA_ID BOX_ID  BOX_POSITION    Population  Concentration (ng/ul)   run_type
DPCh_plate1_A01_S1  CH_Plate1_1A    T144767 T1512   1A  Salmon River Fall   23.4    Fall
DPCh_plate1_A02_S2  CH_Plate1_2A    T144804 T1512   5F  Salmon River Fall   67.4    Fall
DPCh_plate1_A03_S3  CH_Plate1_3A    T145109 T1515   7G  Salmon River Spring 3.52    Spring
DPCh_plate1_A04_S4  CH_Plate1_4A    T145118 T1515   8H  Salmon River Spring 10.3    Spring
DPCh_plate1_A05_S5  CH_Plate1_5A    T144863 T1513   1A  Feather River Hatchery Fall 220 Fall</code></pre>
<p>Then, if we wanted to print the first and the last columns (fields) we could do</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb144-1" data-line-number="1"><span class="fu">awk</span> -F<span class="st">&quot;\t&quot;</span> <span class="st">&#39;{print $1, $NF}&#39;</span> data/wgs-chinook-samples.tsv</a>
<a class="sourceLine" id="cb144-2" data-line-number="2"></a>
<a class="sourceLine" id="cb144-3" data-line-number="3"><span class="co"># the first few lines of output look like:</span></a>
<a class="sourceLine" id="cb144-4" data-line-number="4"><span class="ex">vcf_name</span> run_type</a>
<a class="sourceLine" id="cb144-5" data-line-number="5"><span class="ex">DPCh_plate1_A01_S1</span> Fall</a>
<a class="sourceLine" id="cb144-6" data-line-number="6"><span class="ex">DPCh_plate1_A02_S2</span> Fall</a>
<a class="sourceLine" id="cb144-7" data-line-number="7"><span class="ex">DPCh_plate1_A03_S3</span> Spring</a>
<a class="sourceLine" id="cb144-8" data-line-number="8"><span class="ex">DPCh_plate1_A04_S4</span> Spring</a></code></pre></div>
<p>Notice that if there is no <code>test</code> before the action block, then the action is
done on every line.</p>
<p>The <code>print</code> command prints variables to <em>stdout</em>, if you separate those variables with
a comma, then in the output, they will be separated by the <em>output field sepator</em> which,
by default, is a single space. You can set the <em>output field separator</em> using the <code>OFS</code>
variable, in an action block that is forced to run at the beginning of execution using the
special <code>BEGIN</code> test keyword:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb145-1" data-line-number="1"><span class="fu">awk</span> -F<span class="st">&quot;\t&quot;</span> <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb145-2" data-line-number="2"><span class="st">  BEGIN {OFS=&quot;;&quot;}</span></a>
<a class="sourceLine" id="cb145-3" data-line-number="3"><span class="st">  {print $1, $NF}</span></a>
<a class="sourceLine" id="cb145-4" data-line-number="4"><span class="st">&#39;</span> data/wgs-chinook-samples.tsv</a>
<a class="sourceLine" id="cb145-5" data-line-number="5"></a>
<a class="sourceLine" id="cb145-6" data-line-number="6"><span class="co"># makes output like:</span></a>
<a class="sourceLine" id="cb145-7" data-line-number="7"><span class="ex">vcf_name</span><span class="kw">;</span><span class="ex">run_type</span></a>
<a class="sourceLine" id="cb145-8" data-line-number="8"><span class="ex">DPCh_plate1_A01_S1</span><span class="kw">;</span><span class="ex">Fall</span></a>
<a class="sourceLine" id="cb145-9" data-line-number="9"><span class="ex">DPCh_plate1_A02_S2</span><span class="kw">;</span><span class="ex">Fall</span></a>
<a class="sourceLine" id="cb145-10" data-line-number="10"><span class="ex">DPCh_plate1_A03_S3</span><span class="kw">;</span><span class="ex">Spring</span></a>
<a class="sourceLine" id="cb145-11" data-line-number="11"><span class="ex">DPCh_plate1_A04_S4</span><span class="kw">;</span><span class="ex">Spring</span></a>
<a class="sourceLine" id="cb145-12" data-line-number="12"><span class="ex">DPCh_plate1_A05_S5</span><span class="kw">;</span><span class="ex">Fall</span></a></code></pre></div>
<p>The comma between the arguments to <code>print</code> is what makes <code>awk</code> print the output field
separator between the items. If you
separate arguments to <code>print</code> with just a space (and not a comma), there will be nothing
printed between the two arguments on output. This, coupled with the fact that
<code>print</code> will happily print any strings and numbers (in addition to variables!) you pass to it,
provides a way to do some light formatting of the output text:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb146-1" data-line-number="1"><span class="fu">awk</span> -F<span class="st">&quot;\t&quot;</span> <span class="st">&#39;NR &gt; 1 {print &quot;sample_name:&quot; $1, &quot;run_type:&quot; $NF}&#39;</span> data/wgs-chinook-samples.tsv</a>
<a class="sourceLine" id="cb146-2" data-line-number="2"></a>
<a class="sourceLine" id="cb146-3" data-line-number="3"><span class="co"># gives output like:</span></a>
<a class="sourceLine" id="cb146-4" data-line-number="4"><span class="ex">sample_name</span>:DPCh_plate1_A01_S1 run_type:Fall</a>
<a class="sourceLine" id="cb146-5" data-line-number="5"><span class="ex">sample_name</span>:DPCh_plate1_A02_S2 run_type:Fall</a>
<a class="sourceLine" id="cb146-6" data-line-number="6"><span class="ex">sample_name</span>:DPCh_plate1_A03_S3 run_type:Spring</a>
<a class="sourceLine" id="cb146-7" data-line-number="7"><span class="ex">sample_name</span>:DPCh_plate1_A04_S4 run_type:Spring</a>
<a class="sourceLine" id="cb146-8" data-line-number="8"><span class="ex">sample_name</span>:DPCh_plate1_A05_S5 run_type:Fall</a></code></pre></div>
<p>Note that if you don’t provide an action block after a test, the default action, if the
test is true, is assumed to be “print the whole line as is.” Thus you can use <code>awk</code> to
print matching lines simply like this:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb147-1" data-line-number="1"><span class="fu">awk</span> <span class="st">&#39;/regex/&#39;</span></a></code></pre></div>
<p>where <code>/regex/</code> just means “some regular expression,” as is explained in the
next section.</p>
<p><strong>Now it’s your turn!</strong></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="co"># 1. Using the file data/wgs-chinook-samples.csv, print out the</span></a>
<a class="sourceLine" id="cb148-2" data-line-number="2"><span class="co"># NMFS_DNA_ID the BOX_ID and the BOX_POSITION, separated by periods</span></a>
<a class="sourceLine" id="cb148-3" data-line-number="3"></a></code></pre></div>
</div>
<div id="a-brief-introduction-to-regular-expressions" class="section level3">
<h3><span class="header-section-number">6.1.3</span> A brief introduction to regular expressions</h3>
<p>In a few of the above examples you will see tests that look like: <code>/^@SQ/</code>. This is a regular expression. In
<code>awk</code>, regular expressions are enclosed in forward slashes, so the actual regular expression part
in the above is <code>^@SQ</code>, the enclosing forward slashes are just delimiters that are telling <code>awk</code>, “Hey! The stuff inside here should
be interpreted as a regular expression.”</p>
<p>At this stage, you can think of a regular expression as a “search-string” that <code>awk</code> will try to match
against the text in a line. At its simplest, a regular expression just describes how characters should
match between the regular expression and the line being matched. For example:</p>
<pre><code>/ACGGTC/ </code></pre>
<p>Is saying, “search for the word <code>ACGGTC</code>,” which is something that might find in a DNA string.</p>
<p>If all that regular expressions did was express a search word (like your familiar find function in
Microslop Word, for example), then they would be very easy to learn, but also very limited in
utility. The good news is that all your standard numerals and upper- and lowercase letters work
in regular expressions just like they do in your vanilla “find” function. So, all of the following
regular expressions are just requesting that the word enclosed in the <code>/</code>’s be found:</p>
<pre><code>/Fall/
/A01/
/plate/
/LN/</code></pre>
<p>Regular expressions get more complicated (and useful) because some of the familiar punctuation
marks have special meaning within a regular expression. These are called <em>metacharacters</em>.
The fundamental metacharacters in <code>awk</code> are listed in Table <a href="sed-awk-and-regular-expressions.html#tab:metachars">6.1</a>. It is
worth getting familiar with all of these as most are common to all languages that use
regular expressions, such as R, python, and perl, so learning these will be helpful not
just in using <code>awk</code>, but also in your programming, in general.</p>
<table style="width:72%;">
<caption><span id="tab:metachars">TABLE 6.1: </span> Basic metacharacters used in regular expressions with <code>awk</code>.</caption>
<colgroup>
<col width="26%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Metacharacter(s)</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>.</code></td>
<td align="left">Match any single character</td>
</tr>
<tr class="even">
<td align="left"><code>[ ]</code></td>
<td align="left">Match any single character
from a <em>character class</em> (see
below)</td>
</tr>
<tr class="odd">
<td align="left"><code>^</code></td>
<td align="left">Signifies/matches the
<em>beginning</em> of the line or
word (remember <code>/^@SQ/</code>)</td>
</tr>
<tr class="even">
<td align="left"><code>$</code></td>
<td align="left">Signifies/matches the <em>end</em> of
the line of word</td>
</tr>
<tr class="odd">
<td align="left"><code>*</code></td>
<td align="left">Match zero or more occurrences
of the character (or grouped
pattern) immediately to the
left</td>
</tr>
<tr class="even">
<td align="left"><code>?</code></td>
<td align="left">Match zero or one occurrences
of the character (or grouped
pattern) immediately to the
left</td>
</tr>
<tr class="odd">
<td align="left"><code>+</code></td>
<td align="left">Match one or more occurrences
of the character (or grouped
pattern) immediately to the
left</td>
</tr>
<tr class="even">
<td align="left"><code>{n}</code></td>
<td align="left">Match n occurrences of the
character (or grouped pattern)
immediately to the left</td>
</tr>
<tr class="odd">
<td align="left"><code>{m,n}</code></td>
<td align="left">Match any number between m and
n occurrences of character (or
grouped pattern) immediately
to the left</td>
</tr>
<tr class="even">
<td align="left"><code>|</code></td>
<td align="left">Combine regular expressions
with an OR</td>
</tr>
<tr class="odd">
<td align="left"><code>\</code></td>
<td align="left">Use it if you want to match a
literal metacharacter. For
example <code>\.</code> matches an actual
period, and <code>\?</code> matches an
acutal question mark</td>
</tr>
<tr class="even">
<td align="left"><code>( )</code></td>
<td align="left">Used to group characters into
a single unit to which
modifiers like <code>*</code> or <code>+</code> can
be applied, to delimit the
extent of <code>|</code>’s (or to be used
in more advanced expressions
for inserting replacement
groups)</td>
</tr>
</tbody>
</table>
<p>We note in the above table that more explanation is needed for the concept of <em>character classes</em> defined by <code>[ ]</code>.
These are similar to what you are already
familiar with in terms of <em>globbing</em> file names. In short, if you
put a variety of characters between square brackets, it means “match any one of these characters.”
For example, <code>/[aceACE]/</code> means &quot;match any upper- or lowercase <code>a</code>, <code>c</code>, or <code>e</code>. Within
those square brackets, <code>^</code> and <code>-</code> have special meaning depending on where between
the square brackets they occur:</p>
<ul>
<li>A <code>-</code>, when <em>between</em> letters or numbers, indicates a range: <code>/[a-zA-Z]/</code> means any letter;
/[0-5]/ means any numeral between 0 and 5.</li>
<li>A <code>-</code> at the beginnging or end of the characters inside the square brackets just means <code>-</code>: <code>/[-;ab]/</code> means
match any of the characters <code>-</code>, <code>;</code>, <code>a</code>, or <code>b</code>.</li>
<li>A <code>^</code> <em>at the beginning of the characters inside the square brackets</em> negates the character class, meaning
the match will be to anything <em>not</em> within the character class, i.e., <code>[^ABC]</code> means match any character
that is <em>not</em> <code>A</code> nor <code>B</code> nor <code>C</code>. If the <code>^</code> is not at the beginning of the characters within the <code>[ ]</code>
then it carries no special meaning: <code>[:;^%]</code> matches any of those four punctuation characters.’</li>
<li>All characters, except <code>-</code> and <code>^</code> in the correct positions, and the backslash <code>\</code>, are interpreted <em>literally</em>
(i.e., not as metacharacters) within the <code>[ ]</code>. So you can match any one of <code>?</code>, <code>*</code>, <code>(</code>, <code>)</code>, or <code>+</code>, for instance, with <code>/[?*()+]/</code>.</li>
</ul>
<p>All these metacharacters might seem a little cryptic, so I provide a few
examples, here, that might help to make it more clear. They are presented
(i.e. “match any line”) as if they are part of an <code>awk</code> test.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb151-1" data-line-number="1"><span class="co"># match any line that starts with @RG</span></a>
<a class="sourceLine" id="cb151-2" data-line-number="2">/^<span class="ex">@RG/</span></a>
<a class="sourceLine" id="cb151-3" data-line-number="3"></a>
<a class="sourceLine" id="cb151-4" data-line-number="4"><span class="co"># match any line that starts with @ followed by any two characters</span></a>
<a class="sourceLine" id="cb151-5" data-line-number="5">/^<span class="ex">@../</span></a>
<a class="sourceLine" id="cb151-6" data-line-number="6"></a>
<a class="sourceLine" id="cb151-7" data-line-number="7"><span class="co"># match any line that starts with @ followed by any</span></a>
<a class="sourceLine" id="cb151-8" data-line-number="8"><span class="co"># two uppercase letters</span></a>
<a class="sourceLine" id="cb151-9" data-line-number="9">/^<span class="ex">@</span>[A-Z][A-Z]/</a>
<a class="sourceLine" id="cb151-10" data-line-number="10"></a>
<a class="sourceLine" id="cb151-11" data-line-number="11"><span class="co"># the above could also be written as:</span></a>
<a class="sourceLine" id="cb151-12" data-line-number="12">/^<span class="ex">@</span>[A-Z]<span class="dt">{2}</span>/</a>
<a class="sourceLine" id="cb151-13" data-line-number="13"></a>
<a class="sourceLine" id="cb151-14" data-line-number="14"><span class="co"># This matches phone numbers formatted either like </span></a>
<a class="sourceLine" id="cb151-15" data-line-number="15"><span class="co"># (</span><span class="al">###</span><span class="co">) </span><span class="al">###</span><span class="co">-####, or </span><span class="al">###</span><span class="co">-</span><span class="al">###</span><span class="co">-####</span></a>
<a class="sourceLine" id="cb151-16" data-line-number="16">/<span class="dt">\(</span><span class="ex">?</span>[0-9]<span class="dt">{3}</span>(<span class="dt">\)</span> <span class="kw">|</span><span class="ex">-</span>)[<span class="ex">0-9</span>]<span class="dt">{3}-[0-9]{4}</span>/</a>
<a class="sourceLine" id="cb151-17" data-line-number="17"></a>
<a class="sourceLine" id="cb151-18" data-line-number="18"><span class="co"># And if you can parse that out, you get an A for the day!</span></a>
<a class="sourceLine" id="cb151-19" data-line-number="19"></a>
<a class="sourceLine" id="cb151-20" data-line-number="20"><span class="co"># match anything that starts with T456, then has any</span></a>
<a class="sourceLine" id="cb151-21" data-line-number="21"><span class="co"># number (including 0) of any other characters, then</span></a>
<a class="sourceLine" id="cb151-22" data-line-number="22"><span class="co"># ends with &quot;.fq&quot;</span></a>
<a class="sourceLine" id="cb151-23" data-line-number="23">/<span class="ex">T456.*</span>\.fq/</a>
<a class="sourceLine" id="cb151-24" data-line-number="24"></a>
<a class="sourceLine" id="cb151-25" data-line-number="25"><span class="co"># Note the use of backslash to escape the .</span></a>
<a class="sourceLine" id="cb151-26" data-line-number="26"></a>
<a class="sourceLine" id="cb151-27" data-line-number="27"><span class="co"># Match either &quot;big mess&quot; or &quot;huge mess&quot;</span></a>
<a class="sourceLine" id="cb151-28" data-line-number="28">/<span class="kw">(</span><span class="ex">big</span><span class="kw">|</span><span class="ex">huge</span><span class="kw">)</span> <span class="ex">mess/</span></a></code></pre></div>
<p><strong>Now it’s your turn</strong></p>
<p>Here are some things to try.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb152-1" data-line-number="1"><span class="co"># 1. use alternation (the |) to match lines in the SAM file data/DPCh_plate1_F12_S72.sam</span></a>
<a class="sourceLine" id="cb152-2" data-line-number="2"><span class="co"># that start with either @PG or @RG</span></a>
<a class="sourceLine" id="cb152-3" data-line-number="3"></a>
<a class="sourceLine" id="cb152-4" data-line-number="4"></a>
<a class="sourceLine" id="cb152-5" data-line-number="5"><span class="co"># 2. search through the fastq file data/DPCh_plate1_F12_S72.R1.fq.gz </span></a>
<a class="sourceLine" id="cb152-6" data-line-number="6"><span class="co"># to find any line with exactly two consecutive occurrences of any of the following characters:</span></a>
<a class="sourceLine" id="cb152-7" data-line-number="7"><span class="co"># ! &quot; # $ % &amp;</span></a>
<a class="sourceLine" id="cb152-8" data-line-number="8"></a>
<a class="sourceLine" id="cb152-9" data-line-number="9"></a>
<a class="sourceLine" id="cb152-10" data-line-number="10"><span class="co"># What are we searching for in the above?</span></a></code></pre></div>
</div>
<div id="a-variety-of-tests" class="section level3">
<h3><span class="header-section-number">6.1.4</span> A variety of tests</h3>
<p>When you want to test whether a line will be processed by an action block, or not,
you have many options. Among the major ones (each given with an example or two) are:</p>
<ol style="list-style-type: decimal">
<li><p>match a regular expression anywhere in a line:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb153-1" data-line-number="1"><span class="fu">awk</span> <span class="st">&#39;/^@RG/&#39;</span></a>
<a class="sourceLine" id="cb153-2" data-line-number="2"><span class="fu">awk</span> <span class="st">&#39;/Fall/&#39;</span></a></code></pre></div></li>
<li><p>match a regular expression in a specific column/field</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb154-1" data-line-number="1"><span class="fu">awk</span> <span class="st">&#39;$3 ~ /Sacramento/&#39;</span></a>
<a class="sourceLine" id="cb154-2" data-line-number="2"><span class="fu">awk</span> <span class="st">&#39;$1 ~ /Chr[123]/&#39;</span></a></code></pre></div></li>
<li><p>test for equality, using <code>==</code>, of a single column to a string, or a number. Note
these are <em>not</em> regular expressions, but actual statements of equality. Strings in
such a context are surrounded by double quotes.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb155-1" data-line-number="1"><span class="fu">awk</span> <span class="st">&#39;$1 == &quot;NC_07124.1&quot;&#39;</span></a>
<a class="sourceLine" id="cb155-2" data-line-number="2"><span class="fu">awk</span> <span class="st">&#39;$5 == 100&#39;</span></a></code></pre></div></li>
<li><p>Use comparison operators <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, and <code>!=</code> (not equals) to compare
a column to a string (compared by lexicographical order) or a number
(compared by numerical order)</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb156-1" data-line-number="1"><span class="fu">awk</span> <span class="st">&#39;$2 &lt;= &quot;Aardvark&quot;&#39;</span></a>
<a class="sourceLine" id="cb156-2" data-line-number="2"><span class="fu">awk</span> <span class="st">&#39;$7 &gt; 25&#39;</span></a></code></pre></div></li>
<li><p>test the value of a user-defined variable that may be changing as lines are getting
processed.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb157-1" data-line-number="1"><span class="fu">awk</span> <span class="st">&#39;n &gt; 356&#39;</span></a>
<a class="sourceLine" id="cb157-2" data-line-number="2"><span class="fu">awk</span> <span class="st">&#39;my_word == &quot;Loony&quot;&#39;</span></a></code></pre></div></li>
<li><p>test the value of an internal variable, like <code>NR</code> or <code>NF</code></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb158-1" data-line-number="1"><span class="fu">awk</span> <span class="st">&#39;NR &lt; 25&#39;</span></a>
<a class="sourceLine" id="cb158-2" data-line-number="2"><span class="fu">awk</span> <span class="st">&#39;NF == 13&#39;</span></a></code></pre></div></li>
</ol>
<p>As these tests are effectively things that return a value of TRUE or FALSE, they can
be combined with logical AND and logical OR operators. In awk, the logical AND is
<code>&amp;&amp;</code> and the logical OR is <code>||</code>. To make the intent of long combinations clear, and to
specify specific combinations, the tests can be grouped with parentheses:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb159-1" data-line-number="1"><span class="fu">awk</span> <span class="st">&#39;(units = &quot;days&quot; &amp;&amp; n &gt; 356) || (units == &quot;months&quot; &amp;&amp; n &gt; 12) {print &quot;More than a year!&quot;}&#39;</span></a></code></pre></div>
</div>
<div id="code-in-the-action-blocks" class="section level3">
<h3><span class="header-section-number">6.1.5</span> Code in the action blocks</h3>
<p>Within the action blocks you write computer code to do things, and <code>awk</code> has many features
you expect in a programming language.</p>
<p>Separate lines of code can be ended with a line return (i.e., in scripts), or they can be
ended with a semicolon.
Variable assignment is done with the <code>=</code> sign. Unlike the bash shell, you can have spaces around
the <code>=</code>. One interesting aspect of <code>awk</code> is that the
variables are <em>untyped</em>. This means that you don’t have to tell <code>awk</code> ahead of time whether
a variable is going to hold a number, or a string, etc. Everything is stored as a string,
but when used in a numeric context, if it makes sense, the variable will be treated
as a number. So, you don’t have to worry too much about the type of variables.</p>
<p>If a value has not yet been assigned to a variable, but it is used in a numeric
context, the value is assumed to be 0; if used in a string context, its value
is assumed to be the empty string <code>&quot;&quot;</code>.</p>
<p><strong>You can use <code>for</code> loops within <code>awk</code></strong>. They have the syntax of the C language:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="kw">for(</span><span class="ex">var</span> = initial<span class="kw">;</span> <span class="bu">test</span><span class="kw">;</span> <span class="ex">increment</span><span class="kw">)</span></a></code></pre></div>
<p>For example, this cycles <code>i</code> over values starting from 1, until 10, each
time incrementing the value by 1:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb161-1" data-line-number="1"><span class="kw">for(</span><span class="va">i=</span>1;<span class="ex">i</span><span class="op">&lt;</span>=10<span class="kw">;</span><span class="ex">i++</span><span class="kw">)</span></a></code></pre></div>
<p>Note that the <code>++</code> means “add one to the variable to my left.”</p>
<p>You can also increment by larger amounts. What do you think this would do?</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb162-1" data-line-number="1"><span class="bu">echo</span> boing <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{for(i=5; i&lt;=25; i+=5) print i}&#39;</span> </a></code></pre></div>
<p>If the body of the loop consists of multiple lines of code (or even just one) those lines
can be <em>grouped</em> using curly braces.
Here is an examle of using a <code>for</code> loop to print the columns of the Chinook sample sheet
in row format:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="fu">awk</span> -F<span class="st">&quot;,&quot;</span> <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb163-2" data-line-number="2"><span class="st">  NR == 1 {for(i=1;i&lt;=NF;i++) head[i] = $i; next}</span></a>
<a class="sourceLine" id="cb163-3" data-line-number="3"><span class="st">  {for(i=1;i&lt;=NF;i++) {</span></a>
<a class="sourceLine" id="cb163-4" data-line-number="4"><span class="st">      print i &quot;. &quot; head[i] &quot;: &quot; $i; </span></a>
<a class="sourceLine" id="cb163-5" data-line-number="5"><span class="st">    }</span></a>
<a class="sourceLine" id="cb163-6" data-line-number="6"><span class="st">    print &quot;----------------------&quot;</span></a>
<a class="sourceLine" id="cb163-7" data-line-number="7"><span class="st">  }</span></a>
<a class="sourceLine" id="cb163-8" data-line-number="8"><span class="st">&#39;</span> data/wgs-chinook-samples.csv</a></code></pre></div>
<p><strong>Arrays are implemented as <em>associative arrays</em>.</strong> Thus, rather than being arrays
with elements indexed (and accessed) by natural numbers (i.e. <code>array[1]</code>, <code>array[2]</code>, etc.),
arrays are indexed by any string. This is sometimes called a hash. In python it is
called a <em>dictionary</em>. So, within an awk action block you could see</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb164-1" data-line-number="1"><span class="ex">n</span>[<span class="va">$3</span>]++</a></code></pre></div>
<p>which means “find the element of the array <code>n</code> that is associated with the <em>key</em> $3, and then
add 1 to that element”. This can
be quite useful for counting up the occurrences of different strings or values
in a column. Of course, in order to actually see what the values are, after they
have been counted up, you need to be able
to cycle over all the different <em>keys</em> of the array, and print the key and the
value for each. In <code>awk</code>, you cycle over the keys of an array using</p>
<pre><code>for (i in array)</code></pre>
<p>where <code>for</code> and <code>in</code> are keywords, <code>i</code> is any variable name you want, and <code>array</code> is the
name of an array variable. Unfortunately, you have no control over the <em>order</em> in which the
different keys in the array are visited! Example:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb166-1" data-line-number="1"><span class="co"># count the number of fish from different sampling collections</span></a>
<a class="sourceLine" id="cb166-2" data-line-number="2"><span class="co"># in the wgs-chinook-samples.tsv file:</span></a>
<a class="sourceLine" id="cb166-3" data-line-number="3"><span class="fu">awk</span> -F<span class="st">&quot;\t&quot;</span> <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb166-4" data-line-number="4"><span class="st">  NR &gt; 1 {n[$6]++}</span></a>
<a class="sourceLine" id="cb166-5" data-line-number="5"><span class="st">  END {for(i in n) print i &quot;:&quot;, n[i]}</span></a>
<a class="sourceLine" id="cb166-6" data-line-number="6"><span class="st">&#39;</span> data/wgs-chinook-samples.tsv </a>
<a class="sourceLine" id="cb166-7" data-line-number="7"></a>
<a class="sourceLine" id="cb166-8" data-line-number="8"><span class="co"># gives us:</span></a>
<a class="sourceLine" id="cb166-9" data-line-number="9"><span class="ex">Coleman</span> Hatchery Late Fall: 16</a>
<a class="sourceLine" id="cb166-10" data-line-number="10"><span class="ex">Feather</span> River Hatchery Spring: 16</a>
<a class="sourceLine" id="cb166-11" data-line-number="11"><span class="ex">Feather</span> River Hatchery Fall: 16</a>
<a class="sourceLine" id="cb166-12" data-line-number="12"><span class="ex">Salmon</span> River Spring: 16</a>
<a class="sourceLine" id="cb166-13" data-line-number="13"><span class="ex">Trinity</span> River Hatchery Fall: 16</a>
<a class="sourceLine" id="cb166-14" data-line-number="14"><span class="ex">Trinity</span> River Hatchery Spring: 16</a>
<a class="sourceLine" id="cb166-15" data-line-number="15"><span class="ex">Butte</span> Creek Spring: 16</a>
<a class="sourceLine" id="cb166-16" data-line-number="16"><span class="ex">Sacramento</span> River Winter: 16</a>
<a class="sourceLine" id="cb166-17" data-line-number="17"><span class="ex">Salmon</span> River Fall: 16</a>
<a class="sourceLine" id="cb166-18" data-line-number="18"><span class="ex">San</span> Joaquin River Fall: 16</a></code></pre></div>
<p>The above demonstrates the use of the very important <code>END</code> specifier in the
test position. The <code>END</code> there means “perform the actions in the action block
once all the lines of the file have been processed.”</p>
<p><strong>Now it’s your turn!</strong><br />
We want to cycle through the file <code>DPCh_plate1_F12_S72.R1.fq.gz</code> and
count up the number of times different base-quality sequences occur in the file. The
base quality scores occur on lines 4, 8, 12, … (so, the line number divided by 4 has
no remainder. Note that <code>x % 4</code> gives the remainder when <code>x</code> is divided by 4. We want the
output on each line to be in the format:</p>
<pre><code>Number_of_occurrences  Base_quality_score_sequence</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb168-1" data-line-number="1"><span class="co"># go for it!</span></a>
<a class="sourceLine" id="cb168-2" data-line-number="2"></a></code></pre></div>
<p>After doing that, you might wish that things were sorted differently, like highest to lowest
in terms of # of occurrences. Try piping the output into:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb169-1" data-line-number="1"><span class="fu">sort</span> -n -b -r -k 1</a></code></pre></div>
<p>Pipe that to less and look through it. It is actually pretty cool.</p>
<p><strong>Conditional tests use <code>if</code> and <code>else</code>, with blocking by curly braces.</strong><br />
Below we will demonstrate the use of <code>if</code> and <code>else</code> and, how they can be put together
to make an <code>ifelse</code>-like construction. At the same time we demonstrate how
output from <code>print</code> statements in <code>awk</code> can be redirected to files, from within
the <code>awk</code> script itself. This uses much the same syntax as the shell.</p>
<p>Imagine that we want to put the IDs (called the <code>vcf_names</code>) of the fish
in <code>data/wgs-chinook-samples.csv</code> into separate files, one for each
of the <code>run_types</code> of “Fall”, “Winter”, and “Spring”, and another file
for anything else. We could do that like this:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb170-1" data-line-number="1"><span class="fu">awk</span> -F<span class="st">&quot;,&quot;</span> <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb170-2" data-line-number="2"><span class="st">  NR &gt; 1 {</span></a>
<a class="sourceLine" id="cb170-3" data-line-number="3"><span class="st">    if($NF == &quot;Fall&quot;) {</span></a>
<a class="sourceLine" id="cb170-4" data-line-number="4"><span class="st">      print $1, $NF &gt; &quot;fall.txt&quot;</span></a>
<a class="sourceLine" id="cb170-5" data-line-number="5"><span class="st">    } else if($NF == &quot;Winter&quot;) {</span></a>
<a class="sourceLine" id="cb170-6" data-line-number="6"><span class="st">      print $1, $NF &gt; &quot;winter.txt&quot;</span></a>
<a class="sourceLine" id="cb170-7" data-line-number="7"><span class="st">    } else if($NF == &quot;Spring&quot;) {</span></a>
<a class="sourceLine" id="cb170-8" data-line-number="8"><span class="st">      print $1, $NF &gt; &quot;spring.txt&quot;</span></a>
<a class="sourceLine" id="cb170-9" data-line-number="9"><span class="st">    } else {</span></a>
<a class="sourceLine" id="cb170-10" data-line-number="10"><span class="st">      print $1, $NF &gt; &quot;other.txt&quot;</span></a>
<a class="sourceLine" id="cb170-11" data-line-number="11"><span class="st">    }</span></a>
<a class="sourceLine" id="cb170-12" data-line-number="12"><span class="st">  }</span></a>
<a class="sourceLine" id="cb170-13" data-line-number="13"><span class="st">&#39;</span> data/wgs-chinook-samples.csv</a></code></pre></div>
<p>Now look at the four files produced.</p>
<p><strong>NB:</strong> Parsing CSV files with <code>awk</code> is not always so straightforward as doing <code>-F&quot;,&quot;</code> because
the CSV specification allows for commas that do not separate fields to be hidden within quotation marks.
Don’t expect to parse complex CSV files made by Excel, for example, to be parsed this easily
with <code>awk</code>. It is better to save them as TAB separate files, typically.</p>
<p><strong>Mathematical operations:</strong> <code>awk</code> has got them all: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, as well as “operate and reassign”
versions: <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>, as well as: <code>exp</code>, <code>log</code>, <code>sqrt</code>, <code>sin</code>, <code>cos</code>, and <code>atan2</code></p>
<p><strong>Built in functions:</strong> <code>awk</code> has a limited set of built-in functions. See <code>man awk</code> for a full
listing. The ones I find I use all the time are:</p>
<ul>
<li><code>length(n)</code> : return the number of characters of the variable <code>n</code></li>
<li><code>substr(s, m, n)</code> : return the portion of string <code>s</code> that begins at position <code>m</code>
(counted starting from 1), and is <code>n</code> characters long</li>
<li><code>sub(r, t, s)</code> : substitute string <code>t</code> for the first occurrence of the regular expression <code>r</code> in the string <code>s</code>. If <code>s</code> is not given, <code>$0</code> is used.</li>
<li><code>gsub</code> : just like <code>sub</code> but replaces <em>all</em> (rather than just the first) occurrences of the regular expression <code>r</code> in string <code>s</code>.</li>
<li><code>split(s, a, fs)</code> : split the string <code>s</code> into an array variable named <code>a</code> at occurrences of the regular expression <code>fs</code>.
The function returns the number of pieces the string was split into. Afterward each part of the string can be accessed like
<code>a[1]</code>, <code>a[2]</code>, and so forth. (Good example = splitting out fields from a column in a VCF file.)</li>
</ul>
<p><strong>Take control of output formatting with the <code>printf()</code> function</strong>:<br />
I still need to write this.</p>
</div>
<div id="using-awk-to-assign-to-shell-variables" class="section level3">
<h3><span class="header-section-number">6.1.6</span> Using <code>awk</code> to assign to shell variables</h3>
<p>We leave our discussion of <code>awk</code> by noting that its terse syntax makes it
a perfect tool for creating shell variables that we can do things (like
cycling over them) with.</p>
<p>For example, imagine we wanted to do something to all the FASTQ files associated with
the fish in <code>data/wgs-chinook-samples.csv</code> that are of <code>run_type</code> = “Winter”. We can
get all their IDs using command substitution and then cycle over them in the shell like this:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb171-1" data-line-number="1"><span class="va">WINTERS=$(</span><span class="fu">awk</span> -F<span class="st">&quot;,&quot;</span> <span class="st">&#39;$NF == &quot;Winter&quot; {print $1}&#39;</span> data/wgs-chinook-samples.csv<span class="va">)</span></a>
<a class="sourceLine" id="cb171-2" data-line-number="2"></a>
<a class="sourceLine" id="cb171-3" data-line-number="3"><span class="kw">for</span> <span class="ex">i</span> in <span class="va">$WINTERS</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb171-4" data-line-number="4">  <span class="bu">echo</span> <span class="st">&quot;FASTQS are: </span><span class="va">$i</span><span class="st">.R1.fq.gz     </span><span class="va">$i</span><span class="st">.R2.fq.gz&quot;</span></a>
<a class="sourceLine" id="cb171-5" data-line-number="5"><span class="kw">done</span></a></code></pre></div>
</div>
<div id="passing-variables-into-awk-with--v" class="section level3">
<h3><span class="header-section-number">6.1.7</span> Passing Variables into <code>awk</code> with <code>-v</code></h3>
<p>Gotta let people know about this!</p>
</div>
<div id="writing-awk-scripts-in-files" class="section level3">
<h3><span class="header-section-number">6.1.8</span> Writing awk scripts in files</h3>
<p>Need to do this.</p>
</div>
</div>
<div id="sed" class="section level2">
<h2><span class="header-section-number">6.2</span> sed</h2>
<p><code>sed</code> is a “stream editor”. Though it is capable of all sorts of things,
to be honest, I use it almost exclusively to
do simple find-and-replace operations. The syntax for that is:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb172-1" data-line-number="1"><span class="fu">sed</span> <span class="st">&#39;s/regex/replacement/g;&#39;</span> file</a></code></pre></div>
<p>where <code>regex</code> is a regular expression and <code>replacement</code> is the string you wish to replace
any segments of <code>file</code> that match <code>regex</code>. The <code>s</code> means “substitute” and is like
a command to <code>sed</code>, and the <code>g</code> means “globally”, without which only the first
match of <code>regex</code> on each line would be replaced.</p>
<p>Multiple instances of the “s” command can be given, like:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb173-1" data-line-number="1"><span class="fu">sed</span> <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb173-2" data-line-number="2"><span class="st">  s/regex1/replacement1/g;</span></a>
<a class="sourceLine" id="cb173-3" data-line-number="3"><span class="st">  s/regex2/replacement2/g;</span></a>
<a class="sourceLine" id="cb173-4" data-line-number="4"><span class="st">  s/regex3/replacement3/g;</span></a>
<a class="sourceLine" id="cb173-5" data-line-number="5"><span class="st">&#39;</span> file</a></code></pre></div>
<p>The separate commands are done in order, line by line.</p>
<p><strong>Now it’s your turn!</strong><br />
Take the output of:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb174-1" data-line-number="1"><span class="va">WINTERS=$(</span><span class="fu">awk</span> -F<span class="st">&quot;,&quot;</span> <span class="st">&#39;$NF == &quot;Winter&quot; {print $1}&#39;</span> data/wgs-chinook-samples.csv<span class="va">)</span></a>
<a class="sourceLine" id="cb174-2" data-line-number="2"></a>
<a class="sourceLine" id="cb174-3" data-line-number="3"><span class="kw">for</span> <span class="ex">i</span> in <span class="va">$WINTERS</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb174-4" data-line-number="4">  <span class="bu">echo</span> <span class="st">&quot;FASTQS are: </span><span class="va">$i</span><span class="st">.R1.fq.gz     </span><span class="va">$i</span><span class="st">.R2.fq.gz&quot;</span></a>
<a class="sourceLine" id="cb174-5" data-line-number="5"><span class="kw">done</span></a></code></pre></div>
<p>and pipe it into <code>sed</code> to changes the <code>R1</code> and <code>R2</code> into <code>r1</code> and <code>r2</code>,
and to remove the <code>.gz</code> from the end of each file name. Remember to
backslash-escape that period!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="shell-programming.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="working-on-remote-servers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/eriqande/eca-bioinf-handbook/edit/master/1.02-sed-awk-regex.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/eriqande/eca-bioinf-handbook/commits/master/1.02-sed-awk-regex.Rmd",
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["eca-bioinf-handbook.pdf", "eca-bioinf-handbook.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
